(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{1239:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>B});var s=t(5155),r=t(2115);let i=t(3464).A.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let a=localStorage.getItem("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e});class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}async getNotifications(){return(await i.get("/notifications")).data.data.notifications}async markAsRead(e){await i.put("/notifications/".concat(e,"/read"))}async markAllAsRead(){await i.put("/notifications/read-all")}constructor(){}}let c=n.getInstance(),l=()=>{let[e,a]=(0,r.useState)([]),[t,s]=(0,r.useState)(!1),[i,n]=(0,r.useState)(0),l=(0,r.useCallback)(async()=>{if(0===e.length){s(!0);try{let e=await c.getNotifications();a(e),n(e.filter(e=>!e.read).length)}catch(e){console.error("Error fetching notifications:",e)}finally{s(!1)}}},[e.length]),o=(0,r.useCallback)(async e=>{try{a(a=>a.map(a=>a.id===e?{...a,read:!0}:a)),n(e=>Math.max(0,e-1)),await c.markAsRead(e)}catch(e){console.error("Error marking notification as read:",e),l()}},[l]),d=(0,r.useCallback)(async()=>{try{a(e=>e.map(e=>({...e,read:!0}))),n(0),await c.markAllAsRead()}catch(e){console.error("Error marking all notifications as read:",e),l()}},[l]),h=(0,r.useCallback)(e=>{a(a=>[e,...a]),e.read||n(e=>e+1)},[]);return(0,r.useEffect)(()=>{l()},[l]),{notifications:e,isLoading:t,unreadCount:i,handleMarkAsRead:o,handleMarkAllAsRead:d,addNotification:h,refreshNotifications:l}};var o=t(7449),d=t(112),h=t(2823),u=t(8887),g=t(6029),p=t(3714),x=t(3191),m=t(1220),j=t(6185),y=t(1590),k=t(3751),f=t(6707),v=t(8141),E=t(6467),M=(0,E.A)("outline","heart","IconHeart",[["path",{d:"M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572",key:"svg-0"}]]),A=(0,E.A)("outline","message-circle","IconMessageCircle",[["path",{d:"M3 20l1.3 -3.9c-2.324 -3.437 -1.426 -7.872 2.1 -10.374c3.526 -2.501 8.59 -2.296 11.845 .48c3.255 2.777 3.695 7.266 1.029 10.501c-2.666 3.235 -7.615 4.215 -11.574 2.293l-4.7 1",key:"svg-0"}]]),w=t(5782),b=(0,E.A)("outline","at","IconAt",[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M16 12v1.5a2.5 2.5 0 0 0 5 0v-1.5a9 9 0 1 0 -5.5 8.28",key:"svg-1"}]]),I=(0,E.A)("outline","hash","IconHash",[["path",{d:"M5 9l14 0",key:"svg-0"}],["path",{d:"M5 15l14 0",key:"svg-1"}],["path",{d:"M11 4l-4 16",key:"svg-2"}],["path",{d:"M17 4l-4 16",key:"svg-3"}]]),C=(0,E.A)("outline","eye","IconEye",[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]]),N=(0,E.A)("outline","mood-smile","IconMoodSmile",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 10l.01 0",key:"svg-1"}],["path",{d:"M15 10l.01 0",key:"svg-2"}],["path",{d:"M9.5 15a3.5 3.5 0 0 0 5 0",key:"svg-3"}]]),O=(0,E.A)("outline","check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),z=t(1698),R=t(4076),T=t(2967);let S=e=>{switch(e){case"LIKE":return(0,s.jsx)(M,{size:20,color:"red"});case"COMMENT":return(0,s.jsx)(A,{size:20,color:"blue"});case"FOLLOW":return(0,s.jsx)(w.A,{size:20,color:"green"});case"MENTION":return(0,s.jsx)(b,{size:20,color:"purple"});case"TAG":return(0,s.jsx)(I,{size:20,color:"orange"});case"STORY_VIEW":return(0,s.jsx)(C,{size:20,color:"cyan"});case"STORY_REACTION":return(0,s.jsx)(N,{size:20,color:"yellow"});default:return null}},Y=e=>{switch(e){case"LIKE":return"red";case"COMMENT":return"blue";case"FOLLOW":return"green";case"MENTION":return"purple";case"TAG":return"orange";case"STORY_VIEW":return"cyan";case"STORY_REACTION":return"yellow";default:return"gray"}},_=e=>{let{notification:a,onMarkAsRead:t}=e,r=JSON.parse(a.data);return(0,s.jsx)(o.Z,{withBorder:!0,padding:"lg",radius:"md",style:{opacity:a.isRead?.7:1},children:(0,s.jsxs)(d.Y,{justify:"space-between",align:"flex-start",children:[(0,s.jsxs)(d.Y,{gap:"sm",children:[(0,s.jsx)(h.e,{src:r.actorAvatar,alt:r.actorName,size:"md",radius:"xl"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(u.E,{size:"sm",lineClamp:2,children:[(0,s.jsx)(u.E,{component:"span",fw:500,children:r.actorName})," ",r.message]}),(0,s.jsxs)(d.Y,{gap:"xs",mt:"xs",children:[(0,s.jsx)(g.E,{variant:"light",color:Y(a.type),children:S(a.type)}),(0,s.jsx)(u.E,{size:"xs",c:"dimmed",children:(0,R.m)(new Date(a.createdAt),{addSuffix:!0,locale:T.vi})})]})]})]}),!a.isRead&&(0,s.jsx)(p.m,{label:"Đ\xe1nh dấu đ\xe3 đọc",position:"left",children:(0,s.jsx)(x.M,{variant:"light",color:"blue",size:"lg",radius:"xl",onClick:()=>t(a.id),children:(0,s.jsx)(O,{size:20})})})]})})},L=()=>(0,s.jsx)(m.B,{gap:"md",children:[1,2,3].map(e=>(0,s.jsx)(o.Z,{withBorder:!0,padding:"lg",radius:"md",children:(0,s.jsxs)(d.Y,{gap:"sm",children:[(0,s.jsx)(j.E,{height:40,circle:!0}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)(j.E,{height:20,width:"80%",mb:"xs"}),(0,s.jsx)(j.E,{height:15,width:"40%"})]})]})},e))}),B=()=>{let{notifications:e,isLoading:a,unreadCount:t,handleMarkAsRead:r,handleMarkAllAsRead:i,refreshNotifications:n}=l();return(0,s.jsxs)(y.m,{size:"md",py:"xl",children:[(0,s.jsxs)(d.Y,{justify:"space-between",mb:"xl",children:[(0,s.jsx)(k.h,{order:2,children:"Th\xf4ng b\xe1o"}),(0,s.jsxs)(d.Y,{children:[(0,s.jsx)(f.$,{variant:"light",leftSection:(0,s.jsx)(O,{size:20}),onClick:i,disabled:0===t,children:"Đ\xe1nh dấu tất cả đ\xe3 đọc"}),(0,s.jsx)(f.$,{variant:"light",leftSection:(0,s.jsx)(z.A,{size:20}),onClick:n,children:"L\xe0m mới"})]})]}),a?(0,s.jsx)(L,{}):0===e.length?(0,s.jsx)(v.o,{py:"xl",children:(0,s.jsx)(u.E,{c:"dimmed",children:"Kh\xf4ng c\xf3 th\xf4ng b\xe1o n\xe0o"})}):(0,s.jsx)(m.B,{gap:"md",children:e.map(e=>(0,s.jsx)(_,{notification:e,onMarkAsRead:r},e.id))})]})}},2999:(e,a,t)=>{Promise.resolve().then(t.bind(t,1239))}},e=>{var a=a=>e(e.s=a);e.O(0,[545,207,193,525,440,412,109,226,441,684,358],()=>a(2999)),_N_E=e.O()}]);