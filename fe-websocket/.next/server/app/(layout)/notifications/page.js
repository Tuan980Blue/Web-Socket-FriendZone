(()=>{var e={};e.id=81,e.ids=[81],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4321:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Projects\\\\WebSocket-Social\\\\fe-websocket\\\\src\\\\app\\\\(layout)\\\\notifications\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Projects\\WebSocket-Social\\fe-websocket\\src\\app\\(layout)\\notifications\\page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},18399:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>l});var s=r(65239),a=r(48088),i=r(88170),n=r.n(i),o=r(30893),c={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);r.d(t,c);let l={children:["",{children:["(layout)",{children:["notifications",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4321)),"D:\\Projects\\WebSocket-Social\\fe-websocket\\src\\app\\(layout)\\notifications\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,71941)),"D:\\Projects\\WebSocket-Social\\fe-websocket\\src\\app\\(layout)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"D:\\Projects\\WebSocket-Social\\fe-websocket\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["D:\\Projects\\WebSocket-Social\\fe-websocket\\src\\app\\(layout)\\notifications\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(layout)/notifications/page",pathname:"/notifications",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},49593:(e,t,r)=>{Promise.resolve().then(r.bind(r,70192))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70192:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>W});var s=r(60687),a=r(43210);let i=r(51060).A.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});i.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e});class n{constructor(){}static getInstance(){return n.instance||(n.instance=new n),n.instance}async getNotifications(){return(await i.get("/notifications")).data.data.notifications}async markAsRead(e){await i.put(`/notifications/${e}/read`)}async markAllAsRead(){await i.put("/notifications/read-all")}}let o=n.getInstance(),c=()=>{let[e,t]=(0,a.useState)([]),[r,s]=(0,a.useState)(!1),[i,n]=(0,a.useState)(0),c=(0,a.useCallback)(async()=>{if(0===e.length){s(!0);try{let e=await o.getNotifications();t(e),n(e.filter(e=>!e.read).length)}catch(e){console.error("Error fetching notifications:",e)}finally{s(!1)}}},[e.length]),l=(0,a.useCallback)(async e=>{try{t(t=>t.map(t=>t.id===e?{...t,read:!0}:t)),n(e=>Math.max(0,e-1)),await o.markAsRead(e)}catch(e){console.error("Error marking notification as read:",e),c()}},[c]),d=(0,a.useCallback)(async()=>{try{t(e=>e.map(e=>({...e,read:!0}))),n(0),await o.markAllAsRead()}catch(e){console.error("Error marking all notifications as read:",e),c()}},[c]),u=(0,a.useCallback)(e=>{t(t=>[e,...t]),e.read||n(e=>e+1)},[]);return(0,a.useEffect)(()=>{c()},[c]),{notifications:e,isLoading:r,unreadCount:i,handleMarkAsRead:l,handleMarkAllAsRead:d,addNotification:u,refreshNotifications:c}};var l=r(40346),d=r(99445),u=r(41612),p=r(16537),h=r(61279),x=r(88144),m=r(82287),g=r(68704),f=r(9808),y=r(42176),v=r(23376),j=r(3802),b=r(46521),k=r(6445),w=(0,k.A)("outline","heart","IconHeart",[["path",{d:"M19.5 12.572l-7.5 7.428l-7.5 -7.428a5 5 0 1 1 7.5 -6.566a5 5 0 1 1 7.5 6.572",key:"svg-0"}]]),A=(0,k.A)("outline","message-circle","IconMessageCircle",[["path",{d:"M3 20l1.3 -3.9c-2.324 -3.437 -1.426 -7.872 2.1 -10.374c3.526 -2.501 8.59 -2.296 11.845 .48c3.255 2.777 3.695 7.266 1.029 10.501c-2.666 3.235 -7.615 4.215 -11.574 2.293l-4.7 1",key:"svg-0"}]]),M=r(28560),E=(0,k.A)("outline","at","IconAt",[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M16 12v1.5a2.5 2.5 0 0 0 5 0v-1.5a9 9 0 1 0 -5.5 8.28",key:"svg-1"}]]),P=(0,k.A)("outline","hash","IconHash",[["path",{d:"M5 9l14 0",key:"svg-0"}],["path",{d:"M5 15l14 0",key:"svg-1"}],["path",{d:"M11 4l-4 16",key:"svg-2"}],["path",{d:"M17 4l-4 16",key:"svg-3"}]]),S=(0,k.A)("outline","eye","IconEye",[["path",{d:"M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0",key:"svg-0"}],["path",{d:"M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6",key:"svg-1"}]]),q=(0,k.A)("outline","mood-smile","IconMoodSmile",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 10l.01 0",key:"svg-1"}],["path",{d:"M15 10l.01 0",key:"svg-2"}],["path",{d:"M9.5 15a3.5 3.5 0 0 0 5 0",key:"svg-3"}]]),z=(0,k.A)("outline","check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),C=r(37202),I=r(87552),_=r(72540);let R=e=>{switch(e){case"LIKE":return(0,s.jsx)(w,{size:20,color:"red"});case"COMMENT":return(0,s.jsx)(A,{size:20,color:"blue"});case"FOLLOW":return(0,s.jsx)(M.A,{size:20,color:"green"});case"MENTION":return(0,s.jsx)(E,{size:20,color:"purple"});case"TAG":return(0,s.jsx)(P,{size:20,color:"orange"});case"STORY_VIEW":return(0,s.jsx)(S,{size:20,color:"cyan"});case"STORY_REACTION":return(0,s.jsx)(q,{size:20,color:"yellow"});default:return null}},O=e=>{switch(e){case"LIKE":return"red";case"COMMENT":return"blue";case"FOLLOW":return"green";case"MENTION":return"purple";case"TAG":return"orange";case"STORY_VIEW":return"cyan";case"STORY_REACTION":return"yellow";default:return"gray"}},T=({notification:e,onMarkAsRead:t})=>{let r=JSON.parse(e.data);return(0,s.jsx)(l.Z,{withBorder:!0,padding:"lg",radius:"md",style:{opacity:e.isRead?.7:1},children:(0,s.jsxs)(d.Y,{justify:"space-between",align:"flex-start",children:[(0,s.jsxs)(d.Y,{gap:"sm",children:[(0,s.jsx)(u.e,{src:r.actorAvatar,alt:r.actorName,size:"md",radius:"xl"}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(p.E,{size:"sm",lineClamp:2,children:[(0,s.jsx)(p.E,{component:"span",fw:500,children:r.actorName})," ",r.message]}),(0,s.jsxs)(d.Y,{gap:"xs",mt:"xs",children:[(0,s.jsx)(h.E,{variant:"light",color:O(e.type),children:R(e.type)}),(0,s.jsx)(p.E,{size:"xs",c:"dimmed",children:(0,I.m)(new Date(e.createdAt),{addSuffix:!0,locale:_.vi})})]})]})]}),!e.isRead&&(0,s.jsx)(x.m,{label:"Đ\xe1nh dấu đ\xe3 đọc",position:"left",children:(0,s.jsx)(m.M,{variant:"light",color:"blue",size:"lg",radius:"xl",onClick:()=>t(e.id),children:(0,s.jsx)(z,{size:20})})})]})})},N=()=>(0,s.jsx)(g.B,{gap:"md",children:[1,2,3].map(e=>(0,s.jsx)(l.Z,{withBorder:!0,padding:"lg",radius:"md",children:(0,s.jsxs)(d.Y,{gap:"sm",children:[(0,s.jsx)(f.E,{height:40,circle:!0}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)(f.E,{height:20,width:"80%",mb:"xs"}),(0,s.jsx)(f.E,{height:15,width:"40%"})]})]})},e))}),W=()=>{let{notifications:e,isLoading:t,unreadCount:r,handleMarkAsRead:a,handleMarkAllAsRead:i,refreshNotifications:n}=c();return(0,s.jsxs)(y.m,{size:"md",py:"xl",children:[(0,s.jsxs)(d.Y,{justify:"space-between",mb:"xl",children:[(0,s.jsx)(v.h,{order:2,children:"Th\xf4ng b\xe1o"}),(0,s.jsxs)(d.Y,{children:[(0,s.jsx)(j.$,{variant:"light",leftSection:(0,s.jsx)(z,{size:20}),onClick:i,disabled:0===r,children:"Đ\xe1nh dấu tất cả đ\xe3 đọc"}),(0,s.jsx)(j.$,{variant:"light",leftSection:(0,s.jsx)(C.A,{size:20}),onClick:n,children:"L\xe0m mới"})]})]}),t?(0,s.jsx)(N,{}):0===e.length?(0,s.jsx)(b.o,{py:"xl",children:(0,s.jsx)(p.E,{c:"dimmed",children:"Kh\xf4ng c\xf3 th\xf4ng b\xe1o n\xe0o"})}):(0,s.jsx)(g.B,{gap:"md",children:e.map(e=>(0,s.jsx)(T,{notification:e,onMarkAsRead:a},e.id))})]})}},74075:e=>{"use strict";e.exports=require("zlib")},78969:(e,t,r)=>{Promise.resolve().then(r.bind(r,4321))},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,27,658,760,594,409,822,670],()=>r(18399));module.exports=s})();