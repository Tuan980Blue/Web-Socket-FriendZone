(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[883],{776:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>N});var i=s(5155),o=s(2115);let n=s(3464).A.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let l=localStorage.getItem("token");return l&&(e.headers.Authorization="Bearer ".concat(l)),e});class t{static getInstance(){return t.instance||(t.instance=new t),t.instance}async getFollowers(){return(await n.get("/follows")).data.data}async getFollowing(){return(await n.get("/follows/following")).data.data}async getSuggestions(){return(await n.get("/follows/suggestions")).data.data}async followUser(e){await n.post("/follows/follow/".concat(e))}async unfollowUser(e){await n.delete("/follows/unfollow/".concat(e))}constructor(){}}let a=t.getInstance(),r=()=>{let[e,l]=(0,o.useState)("followers"),[s,i]=(0,o.useState)([]),[n,t]=(0,o.useState)([]),[r,d]=(0,o.useState)([]),[c,g]=(0,o.useState)({followers:!1,following:!1,suggestions:!1}),u=(0,o.useCallback)(async()=>{if(0===s.length){g(e=>({...e,followers:!0}));try{let e=await a.getFollowers();i(e)}catch(e){console.error("Error fetching followers:",e)}finally{g(e=>({...e,followers:!1}))}}},[s.length]),h=(0,o.useCallback)(async()=>{if(0===n.length){g(e=>({...e,following:!0}));try{let e=await a.getFollowing();t(e)}catch(e){console.error("Error fetching following:",e)}finally{g(e=>({...e,following:!1}))}}},[n.length]),x=(0,o.useCallback)(async()=>{if(0===r.length){g(e=>({...e,suggestions:!0}));try{let e=await a.getSuggestions();d(e)}catch(e){console.error("Error fetching suggestions:",e)}finally{g(e=>({...e,suggestions:!1}))}}},[r.length]),w=(0,o.useCallback)(async e=>{try{d(l=>l.map(l=>l.id===e?{...l,isFollowing:!0}:l)),await a.followUser(e),d(l=>l.map(l=>l.id===e?{...l,followersCount:l.followersCount+1}:l))}catch(l){console.error("Error following user:",l),d(l=>l.map(l=>l.id===e?{...l,isFollowing:!1}:l))}},[]),j=(0,o.useCallback)(async e=>{try{t(l=>l.filter(l=>l.id!==e)),await a.unfollowUser(e)}catch(e){console.error("Error unfollowing user:",e),h()}},[h]),m=(0,o.useCallback)(e=>{switch(e){case"followers":u();break;case"following":h();break;case"suggestions":x()}},[u,h,x]);return{followers:s,following:n,suggestions:r,activeTab:e,setActiveTab:(0,o.useCallback)(e=>{l(e),m(e)},[m]),isLoadingFollowers:c.followers,isLoadingFollowing:c.following,isLoadingSuggestions:c.suggestions,handleFollow:w,handleUnfollow:j,refreshSuggestions:x}};var d=s(7449),c=s(112),g=s(2823),u=s(8887),h=s(6029),x=s(3714),w=s(3191),j=s(6707),m=s(1220),f=s(6185),p=s(1590),b=s(3751),v=s(8004),y=s(3776),E=s(8141),C=s(2737),F=s(48),z=s(5782),k=s(1698),S=s(4076),B=s(2967);let L=e=>{let{user:l,onFollow:s,onUnfollow:o,isLoading:n,showMutualFollowers:t=!1}=e;return(0,i.jsx)(d.Z,{withBorder:!0,padding:"lg",radius:"md",children:(0,i.jsxs)(c.Y,{justify:"space-between",align:"flex-start",children:[(0,i.jsxs)(c.Y,{gap:"sm",children:[(0,i.jsx)(g.e,{src:l.avatar,alt:l.username,size:"lg",radius:"xl"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(u.E,{fw:500,size:"lg",children:l.fullName}),(0,i.jsxs)(u.E,{size:"sm",c:"dimmed",children:["@",l.username]}),l.bio&&(0,i.jsx)(u.E,{size:"sm",mt:"xs",lineClamp:2,children:l.bio}),(0,i.jsxs)(c.Y,{gap:"xs",mt:"xs",children:[(0,i.jsx)(h.E,{variant:"light",color:"ONLINE"===l.status?"green":"gray",children:l.status}),(0,i.jsxs)(c.Y,{gap:4,children:[(0,i.jsx)(C.A,{size:14}),(0,i.jsx)(u.E,{size:"xs",c:"dimmed",children:(0,S.m)(new Date(l.lastSeen),{addSuffix:!0,locale:B.vi})})]}),t&&l.mutualFollowersCount&&l.mutualFollowersCount>0&&(0,i.jsxs)(u.E,{size:"xs",c:"dimmed",children:[l.mutualFollowersCount," bạn chung"]})]})]})]}),(0,i.jsx)(x.m,{label:l.isFollowing?"Hủy theo d\xf5i":"Theo d\xf5i",position:"left",children:(0,i.jsx)(w.M,{variant:l.isFollowing?"light":"filled",color:l.isFollowing?"red":"blue",size:"lg",radius:"xl",onClick:()=>l.isFollowing?o(l.id):s(l.id),loading:n,children:l.isFollowing?(0,i.jsx)(F.A,{size:20}):(0,i.jsx)(z.A,{size:20})})})]})})},T=e=>{let{user:l,onFollow:s,isLoading:o}=e;return(0,i.jsx)(d.Z,{withBorder:!0,padding:"md",radius:"md",children:(0,i.jsxs)(c.Y,{justify:"space-between",align:"center",children:[(0,i.jsxs)(c.Y,{gap:"sm",children:[(0,i.jsx)(g.e,{src:l.avatar,alt:l.username,size:"md",radius:"xl"}),(0,i.jsxs)("div",{children:[(0,i.jsx)(u.E,{fw:500,size:"sm",children:l.fullName}),(0,i.jsxs)(u.E,{size:"xs",c:"dimmed",children:["@",l.username]}),l.mutualFollowersCount&&l.mutualFollowersCount>0&&(0,i.jsxs)(u.E,{size:"xs",c:"dimmed",mt:2,children:[l.mutualFollowersCount," bạn chung"]})]})]}),(0,i.jsx)(j.$,{variant:"light",color:"blue",size:"xs",radius:"xl",leftSection:(0,i.jsx)(z.A,{size:14}),onClick:()=>s(l.id),loading:o,children:"Theo d\xf5i"})]})})},Y=()=>(0,i.jsx)(m.B,{gap:"md",children:[1,2,3].map(e=>(0,i.jsx)(d.Z,{withBorder:!0,padding:"lg",radius:"md",children:(0,i.jsxs)(c.Y,{gap:"sm",children:[(0,i.jsx)(f.E,{height:50,circle:!0}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)(f.E,{height:20,width:"40%",mb:"xs"}),(0,i.jsx)(f.E,{height:15,width:"20%"})]})]})},e))}),A=()=>(0,i.jsx)(m.B,{gap:"md",children:[1,2,3,4,5].map(e=>(0,i.jsx)(d.Z,{withBorder:!0,padding:"md",radius:"md",children:(0,i.jsxs)(c.Y,{gap:"sm",children:[(0,i.jsx)(f.E,{height:40,circle:!0}),(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsx)(f.E,{height:16,width:"30%",mb:"xs"}),(0,i.jsx)(f.E,{height:12,width:"20%"})]}),(0,i.jsx)(f.E,{height:24,width:80,radius:"xl"})]})},e))}),N=()=>{let{followers:e,following:l,suggestions:s,activeTab:n,setActiveTab:t,handleFollow:a,handleUnfollow:d,refreshSuggestions:g}=r(),[h,x]=(0,o.useState)(!1),[w,f]=(0,o.useState)(!1),[C,F]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{"followers"===n?(x(!0),setTimeout(()=>x(!1),500)):"following"===n?(f(!0),setTimeout(()=>f(!1),500)):"suggestions"===n&&(F(!0),setTimeout(()=>F(!1),500))},[n]),(0,i.jsxs)(p.m,{size:"md",py:"xl",children:[(0,i.jsx)(b.h,{order:2,mb:"xl",children:"Quan hệ"}),(0,i.jsxs)(v.t,{value:n,onChange:e=>{("followers"===e||"following"===e||"suggestions"===e)&&t(e)},children:[(0,i.jsxs)(v.t.List,{grow:!0,mb:"md",children:[(0,i.jsxs)(v.t.Tab,{value:"followers",children:["Người theo d\xf5i (",(null==e?void 0:e.length)||0,")"]}),(0,i.jsxs)(v.t.Tab,{value:"following",children:["Đang theo d\xf5i (",(null==l?void 0:l.length)||0,")"]}),(0,i.jsxs)(v.t.Tab,{value:"suggestions",children:["Gợi \xfd (",(null==s?void 0:s.length)||0,")"]})]}),(0,i.jsx)(v.t.Panel,{value:"followers",children:h?(0,i.jsx)(Y,{}):(0,i.jsxs)(m.B,{gap:"md",children:[null==e?void 0:e.map(e=>(0,i.jsx)(L,{user:e,onFollow:a,onUnfollow:d,isLoading:h},e.id)),(null==e?void 0:e.length)===0&&(0,i.jsx)(u.E,{c:"dimmed",ta:"center",py:"xl",children:"Chưa c\xf3 người theo d\xf5i"})]})}),(0,i.jsx)(v.t.Panel,{value:"following",children:w?(0,i.jsx)(Y,{}):(0,i.jsxs)(m.B,{gap:"md",children:[null==l?void 0:l.map(e=>(0,i.jsx)(L,{user:e,onFollow:a,onUnfollow:d,isLoading:w},e.id)),(null==l?void 0:l.length)===0&&(0,i.jsx)(u.E,{c:"dimmed",ta:"center",py:"xl",children:"Chưa theo d\xf5i ai"})]})}),(0,i.jsx)(v.t.Panel,{value:"suggestions",children:(0,i.jsxs)(m.B,{gap:"md",children:[(0,i.jsxs)(c.Y,{justify:"space-between",align:"center",children:[(0,i.jsx)(u.E,{fw:500,size:"lg",children:"Gợi \xfd cho bạn"}),(0,i.jsx)(j.$,{variant:"subtle",color:"gray",size:"xs",leftSection:(0,i.jsx)(k.A,{size:14}),onClick:g,loading:C,children:"L\xe0m mới"})]}),(0,i.jsx)(y.c,{}),C?(0,i.jsx)(A,{}):(0,i.jsxs)(m.B,{gap:"md",children:[null==s?void 0:s.map(e=>(0,i.jsx)(T,{user:e,onFollow:a,onUnfollow:d,isLoading:C,showMutualFollowers:!0},e.id)),(null==s?void 0:s.length)===0&&(0,i.jsx)(E.o,{py:"xl",children:(0,i.jsx)(u.E,{c:"dimmed",ta:"center",children:"Kh\xf4ng c\xf3 gợi \xfd n\xe0o"})})]})]})})]})]})}},965:(e,l,s)=>{Promise.resolve().then(s.bind(s,776))}},e=>{var l=l=>e(e.s=l);e.O(0,[545,207,193,525,440,412,109,226,890,441,684,358],()=>l(965)),_N_E=e.O()}]);