(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[365],{3874:(e,r,t)=>{Promise.resolve().then(t.bind(t,4101))},4101:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>q});var s=t(5155),a=t(2115),l=t(5695),o=t(9573),n=t(1590),i=t(3751),u=t(7287),d=t(8004),c=t(5903),h=t(3420),m=t(5782),g=t(1220),p=t(8593),b=t(5345),w=t(112),x=t(8887),j=t(6707),f=t(1659),v=t(6942);let y=t(3464).A.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});y.interceptors.request.use(e=>{let r=localStorage.getItem("token");return r&&(e.headers.Authorization="Bearer ".concat(r)),e});let P={register:async e=>(await y.post("/auth/register",e)).data,login:async e=>(await y.post("/auth/login",e)).data};var E=t(4781);function S(){let[e,r]=(0,a.useState)(!1),t=(0,l.useRouter)(),{setUser:o}=(0,E.P)(),n=(0,f.m)({initialValues:{email:"",password:""},validate:{email:e=>/^\S+@\S+$/.test(e)?null:"Invalid email",password:e=>e.length<6?"Password must be at least 6 characters":null}}),i=async e=>{try{r(!0);let s=await P.login(e);localStorage.setItem("token",s.token),o(s.user),v.$e.show({title:"Success",message:"Login successful!",color:"green"}),t.push("/")}catch(e){var s,a;v.$e.show({title:"Error",message:(null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.error)||"Login failed",color:"red"})}finally{r(!1)}};return(0,s.jsx)("form",{onSubmit:n.onSubmit(i),children:(0,s.jsxs)(g.B,{children:[(0,s.jsx)(p.k,{required:!0,label:"Email",placeholder:"Enter your email",...n.getInputProps("email")}),(0,s.jsx)(b.y,{required:!0,label:"Password",placeholder:"Enter your password",...n.getInputProps("password")}),(0,s.jsxs)(w.Y,{justify:"space-between",mt:"xl",children:[(0,s.jsxs)(x.E,{size:"sm",c:"dimmed",children:["Don't have an account?"," ",(0,s.jsx)(x.E,{component:"span",c:"blue",style:{cursor:"pointer"},onClick:()=>t.push("/auth?tab=register"),children:"Register"})]}),(0,s.jsx)(j.$,{type:"submit",loading:e,children:"Login"})]})]})})}var I=t(3517),k=t(2087);function D(){let[e,r]=(0,a.useState)(!1),t=(0,l.useRouter)(),o=(0,f.m)({initialValues:{username:"",email:"",password:"",confirmPassword:"",fullName:"",gender:"",birthDate:null},validate:{username:e=>e.length<3?"Username must be at least 3 characters":null,email:e=>/^\S+@\S+$/.test(e)?null:"Invalid email",password:e=>e.length<6?"Password must be at least 6 characters":null,confirmPassword:(e,r)=>e!==r.password?"Passwords do not match":null,fullName:e=>e.length<2?"Full name must be at least 2 characters":null,gender:e=>e?null:"Please select your gender",birthDate:e=>e?null:"Please select your birth date"}}),n=async e=>{var s,a,l;try{if(r(!0),e.password!==e.confirmPassword){v.$e.show({title:"Error",message:"Passwords do not match",color:"red"});return}await P.register({username:e.username,email:e.email,password:e.password,fullName:e.fullName,gender:e.gender,birthDate:(null===(s=e.birthDate)||void 0===s?void 0:s.toISOString())||null}),v.$e.show({title:"Success",message:"Registration successful! Please login with your credentials.",color:"green"}),t.push("/auth?tab=login")}catch(e){v.$e.show({title:"Error",message:(null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.error)||"Registration failed",color:"red"})}finally{r(!1)}};return(0,s.jsx)("form",{onSubmit:o.onSubmit(n),children:(0,s.jsxs)(g.B,{children:[(0,s.jsx)(p.k,{required:!0,label:"Username",placeholder:"Enter your username",...o.getInputProps("username")}),(0,s.jsx)(p.k,{required:!0,label:"Email",placeholder:"Enter your email",...o.getInputProps("email")}),(0,s.jsx)(b.y,{required:!0,label:"Password",placeholder:"Enter your password",...o.getInputProps("password")}),(0,s.jsx)(b.y,{required:!0,label:"Confirm Password",placeholder:"Confirm your password",...o.getInputProps("confirmPassword")}),(0,s.jsx)(p.k,{required:!0,label:"Full Name",placeholder:"Enter your full name",...o.getInputProps("fullName")}),(0,s.jsx)(I.l,{required:!0,label:"Gender",placeholder:"Select your gender",data:[{value:"MALE",label:"Male"},{value:"FEMALE",label:"Female"},{value:"OTHER",label:"Other"}],...o.getInputProps("gender")}),(0,s.jsx)(k.J,{required:!0,label:"Birth Date",placeholder:"Select your birth date",maxDate:new Date,...o.getInputProps("birthDate")}),(0,s.jsxs)(w.Y,{justify:"space-between",mt:"xl",children:[(0,s.jsxs)(x.E,{size:"sm",c:"dimmed",children:["Already have an account?"," ",(0,s.jsx)(x.E,{component:"span",c:"blue",style:{cursor:"pointer"},onClick:()=>t.push("/auth?tab=login"),children:"Login"})]}),(0,s.jsx)(j.$,{type:"submit",loading:e,children:"Register"})]})]})})}function q(){let e=(0,l.useRouter)(),r=(0,l.useSearchParams)(),[t,g]=(0,a.useState)("login");return(0,a.useEffect)(()=>{let t=localStorage.getItem("token"),s=localStorage.getItem("user");t&&s&&e.push("/");let a=r.get("tab");("register"===a||"login"===a)&&g(a)},[e,r]),(0,s.jsxs)("main",{children:[(0,s.jsx)(o.$,{position:"top-right"}),(0,s.jsxs)(n.m,{size:420,my:40,children:[(0,s.jsx)(i.h,{ta:"center",fw:900,children:"Welcome back!"}),(0,s.jsx)(u.t,{withBorder:!0,shadow:"md",p:30,mt:30,radius:"md",children:(0,s.jsxs)(d.t,{value:t,onChange:r=>{g(r),e.push("login"===r?"/auth":"/auth?tab=register")},children:[(0,s.jsxs)(d.t.List,{grow:!0,mb:"md",children:[(0,s.jsx)(d.t.Tab,{value:"login",leftSection:(0,s.jsx)(h.A,{style:{width:(0,c.D)(16),height:(0,c.D)(16)}}),children:"Login"}),(0,s.jsx)(d.t.Tab,{value:"register",leftSection:(0,s.jsx)(m.A,{style:{width:(0,c.D)(16),height:(0,c.D)(16)}}),children:"Register"})]}),(0,s.jsx)(d.t.Panel,{value:"login",children:(0,s.jsx)(S,{})}),(0,s.jsx)(d.t.Panel,{value:"register",children:(0,s.jsx)(D,{})})]})})]})]})}},4781:(e,r,t)=>{"use strict";t.d(r,{P:()=>l});var s=t(2115);t(5155);let a=(0,s.createContext)(void 0),l=()=>{let e=(0,s.useContext)(a);if(void 0===e)throw Error("useUserData must be used within a UserProvider");return e}}},e=>{var r=r=>e(e.s=r);e.O(0,[545,45,939,335,600,441,684,358],()=>r(3874)),_N_E=e.O()}]);