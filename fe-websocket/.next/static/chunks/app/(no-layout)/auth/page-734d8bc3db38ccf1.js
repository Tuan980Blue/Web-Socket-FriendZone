(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[133],{213:(e,r,t)=>{Promise.resolve().then(t.bind(t,6073))},722:(e,r,t)=>{"use strict";t.d(r,{j:()=>s});let a=t(3464).A.create({baseURL:"http://localhost:3001/api",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(e=>{let r=localStorage.getItem("token");return r&&(e.headers.Authorization="Bearer ".concat(r)),e});let s={register:async e=>(await a.post("/auth/register",e)).data,login:async e=>(await a.post("/auth/login",e)).data,forgotPassword:async e=>(await a.post("/auth/forgot-password",{email:e})).data,getCurrentUser:async()=>(await a.get("/auth/me")).data}},5407:(e,r,t)=>{"use strict";t.d(r,{R:()=>i,v:()=>o});var a=t(5155),s=t(2115),l=t(722);let i=(0,s.createContext)(void 0),o=e=>{let{children:r}=e,[t,o]=(0,s.useState)(null),[n,d]=(0,s.useState)(!0),[u,c]=(0,s.useState)(null),m=async()=>{try{if(!localStorage.getItem("token")){o(null);return}let e=await l.j.getCurrentUser();o(e.user)}catch(e){console.error("Error fetching user data:",e),c("Failed to load user data"),o(null),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("tokenExpiration")}finally{d(!1)}};return(0,s.useEffect)(()=>{m()},[]),(0,a.jsx)(i.Provider,{value:{user:t,setUser:e=>{if(o(e),e){let r=new Date().getTime()+864e5;localStorage.setItem("tokenExpiration",r.toString()),localStorage.setItem("user",JSON.stringify(e))}else localStorage.removeItem("user"),localStorage.removeItem("tokenExpiration")},isLoading:n,error:u,refreshUserData:m},children:r})}},6073:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>L});var a=t(5155),s=t(2115),l=t(5695),i=t(9573),o=t(3131),n=t(1590),d=t(7203),u=t(8160),c=t(112),m=t(8887),g=t(3751),h=t(7287),p=t(8004),x=t(5903),b=t(3347),v=t(3420),y=t(5782),f=t(1220),j=t(8593),w=t(5345),k=t(6707),S=t(3776),C=t(1659),E=t(6942),P=t(722),z=t(8268),I=t(4713),D=t(3232);function A(){let[e,r]=(0,s.useState)(!1),t=(0,l.useRouter)(),{setUser:i}=(0,z.P)(),o=(0,C.m)({initialValues:{email:"",password:""},validate:{email:e=>/^\S+@\S+$/.test(e)?null:"Invalid email",password:e=>e.length<6?"Password must be at least 6 characters":null}}),n=async e=>{try{r(!0);let a=await P.j.login(e);localStorage.setItem("token",a.token),i(a.user),E.$e.show({title:"Success",message:"Login successful!",color:"green"}),t.push("/")}catch(e){var a,s;E.$e.show({title:"Error",message:(null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Login failed",color:"red"})}finally{r(!1)}};return(0,a.jsx)("form",{onSubmit:o.onSubmit(n),children:(0,a.jsxs)(f.B,{gap:"sm",children:[(0,a.jsx)(j.k,{required:!0,size:"sm",label:"Email",placeholder:"Enter your email",radius:"md",...o.getInputProps("email"),styles:{input:{"&:focus":{borderColor:"var(--primary-gradient-via)"}}}}),(0,a.jsx)(w.y,{required:!0,size:"sm",label:"Password",placeholder:"Enter your password",radius:"md",...o.getInputProps("password"),styles:{input:{"&:focus":{borderColor:"var(--primary-gradient-via)"}}}}),(0,a.jsx)(m.E,{size:"xs",c:"blue",style:{cursor:"pointer",alignSelf:"flex-end"},onClick:()=>t.push("/auth?tab=forgot-password"),children:"Forgot password?"}),(0,a.jsx)(k.$,{type:"submit",loading:e,size:"sm",radius:"md",fullWidth:!0,mt:"xs",style:{background:"linear-gradient(45deg, var(--primary-gradient-from), var(--primary-gradient-via), var(--primary-gradient-to))"},children:"Log in"}),(0,a.jsxs)(c.Y,{gap:"xs",justify:"center",mt:"xs",children:[(0,a.jsx)(S.c,{w:80}),(0,a.jsx)(m.E,{size:"xs",c:"dimmed",children:"or"}),(0,a.jsx)(S.c,{w:80})]}),(0,a.jsxs)(c.Y,{grow:!0,children:[(0,a.jsx)(k.$,{variant:"default",size:"sm",radius:"md",leftSection:(0,a.jsx)(I.A,{style:{width:(0,x.D)(16),height:(0,x.D)(16),color:"orangered"}}),styles:{root:{borderColor:"var(--border)","&:hover":{backgroundColor:"var(--background)"}}},children:"Google"}),(0,a.jsx)(k.$,{variant:"default",size:"sm",radius:"md",leftSection:(0,a.jsx)(D.A,{style:{width:(0,x.D)(16),height:(0,x.D)(16),color:"blue"}}),styles:{root:{borderColor:"var(--border)","&:hover":{backgroundColor:"var(--background)"}}},children:"Facebook"})]}),(0,a.jsx)(c.Y,{justify:"center",mt:"xs",children:(0,a.jsxs)(m.E,{size:"xs",c:"dimmed",children:["Don't have an account?"," ",(0,a.jsx)(m.E,{component:"span",style:{cursor:"pointer",background:"linear-gradient(45deg, var(--primary-gradient-from), var(--primary-gradient-via), var(--primary-gradient-to))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},onClick:()=>t.push("/auth?tab=register"),children:"Sign up"})]})})]})})}var N=t(3517),F=t(2087);function $(){let[e,r]=(0,s.useState)(!1),t=(0,l.useRouter)(),i=(0,C.m)({initialValues:{username:"",email:"",password:"",confirmPassword:"",fullName:"",gender:"",birthDate:null},validate:{username:e=>e.length<3?"Username must be at least 3 characters":null,email:e=>/^\S+@\S+$/.test(e)?null:"Invalid email",password:e=>e.length<6?"Password must be at least 6 characters":null,confirmPassword:(e,r)=>e!==r.password?"Passwords do not match":null,fullName:e=>e.length<2?"Full name must be at least 2 characters":null,gender:e=>e?null:"Please select your gender",birthDate:e=>e?null:"Please select your birth date"}}),o=async e=>{var a,s,l;try{r(!0);let{confirmPassword:s,...l}=e;await P.j.register({...l,birthDate:(null===(a=l.birthDate)||void 0===a?void 0:a.toISOString())||null}),E.$e.show({title:"Success",message:"Registration successful! Please login with your credentials.",color:"green"}),t.push("/auth?tab=login")}catch(e){E.$e.show({title:"Error",message:(null===(l=e.response)||void 0===l?void 0:null===(s=l.data)||void 0===s?void 0:s.error)||"Registration failed",color:"red"})}finally{r(!1)}},n={input:{"&:focus":{borderColor:"var(--primary-gradient-via)"}}};return(0,a.jsx)("form",{onSubmit:i.onSubmit(o),children:(0,a.jsxs)(f.B,{gap:"sm",children:[(0,a.jsx)(j.k,{required:!0,size:"sm",label:"Username",placeholder:"Choose a username",radius:"md",...i.getInputProps("username"),styles:n}),(0,a.jsx)(j.k,{required:!0,size:"sm",label:"Email",placeholder:"Enter your email",radius:"md",...i.getInputProps("email"),styles:n}),(0,a.jsx)(w.y,{required:!0,size:"sm",label:"Password",placeholder:"Create a password",radius:"md",...i.getInputProps("password"),styles:n}),(0,a.jsx)(w.y,{required:!0,size:"sm",label:"Confirm Password",placeholder:"Confirm your password",radius:"md",...i.getInputProps("confirmPassword"),styles:n}),(0,a.jsx)(j.k,{required:!0,size:"sm",label:"Full Name",placeholder:"Enter your full name",radius:"md",...i.getInputProps("fullName"),styles:n}),(0,a.jsx)(N.l,{required:!0,size:"sm",label:"Gender",placeholder:"Select your gender",radius:"md",data:[{value:"MALE",label:"Male"},{value:"FEMALE",label:"Female"},{value:"OTHER",label:"Other"}],...i.getInputProps("gender"),styles:n}),(0,a.jsx)(F.J,{required:!0,size:"sm",label:"Birth Date",placeholder:"Select your birth date",radius:"md",maxDate:new Date,...i.getInputProps("birthDate"),styles:n}),(0,a.jsx)(k.$,{type:"submit",loading:e,size:"sm",radius:"md",fullWidth:!0,mt:"xs",style:{background:"linear-gradient(45deg, var(--primary-gradient-from), var(--primary-gradient-via), var(--primary-gradient-to))"},children:"Create Account"}),(0,a.jsxs)(c.Y,{gap:"xs",justify:"center",mt:"xs",children:[(0,a.jsx)(S.c,{w:80}),(0,a.jsx)(m.E,{size:"xs",c:"dimmed",children:"or"}),(0,a.jsx)(S.c,{w:80})]}),(0,a.jsxs)(c.Y,{grow:!0,children:[(0,a.jsx)(k.$,{variant:"default",size:"sm",radius:"md",leftSection:(0,a.jsx)(I.A,{style:{width:(0,x.D)(16),height:(0,x.D)(16),color:"orangered"}}),styles:{root:{borderColor:"var(--border)","&:hover":{backgroundColor:"var(--background)"}}},children:"Google"}),(0,a.jsx)(k.$,{variant:"default",size:"sm",radius:"md",leftSection:(0,a.jsx)(D.A,{style:{width:(0,x.D)(16),height:(0,x.D)(16),color:"blue"}}),styles:{root:{borderColor:"var(--border)","&:hover":{backgroundColor:"var(--background)"}}},children:"Facebook"})]}),(0,a.jsx)(c.Y,{justify:"center",mt:"xs",children:(0,a.jsxs)(m.E,{size:"xs",c:"dimmed",children:["Already have an account?"," ",(0,a.jsx)(m.E,{component:"span",style:{cursor:"pointer",background:"linear-gradient(45deg, var(--primary-gradient-from), var(--primary-gradient-via), var(--primary-gradient-to))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},onClick:()=>t.push("/auth?tab=login"),children:"Log in"})]})})]})})}function R(){let[e,r]=(0,s.useState)(!1),t=(0,l.useRouter)(),i=(0,C.m)({initialValues:{email:""},validate:{email:e=>/^\S+@\S+$/.test(e)?null:"Invalid email"}}),o=async e=>{try{r(!0),await P.j.forgotPassword(e.email),E.$e.show({title:"Success",message:"Password reset instructions have been sent to your email.",color:"green"}),t.push("/auth?tab=login")}catch(e){var a,s;E.$e.show({title:"Error",message:(null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.error)||"Failed to process request",color:"red"})}finally{r(!1)}};return(0,a.jsx)("form",{onSubmit:i.onSubmit(o),children:(0,a.jsxs)(f.B,{gap:"sm",children:[(0,a.jsx)(m.E,{size:"sm",c:"dimmed",ta:"center",mb:"md",children:"Enter your email address and we will send you instructions to reset your password."}),(0,a.jsx)(j.k,{required:!0,size:"sm",label:"Email",placeholder:"Enter your email",radius:"md",...i.getInputProps("email"),styles:{input:{"&:focus":{borderColor:"var(--primary-gradient-via)"}}}}),(0,a.jsx)(k.$,{type:"submit",loading:e,size:"sm",radius:"md",fullWidth:!0,mt:"xs",style:{background:"linear-gradient(45deg, var(--primary-gradient-from), var(--primary-gradient-via), var(--primary-gradient-to))"},children:"Send Reset Instructions"}),(0,a.jsx)(c.Y,{justify:"center",mt:"xs",children:(0,a.jsxs)(m.E,{size:"xs",c:"dimmed",children:["Remember your password?"," ",(0,a.jsx)(m.E,{component:"span",style:{cursor:"pointer",background:"linear-gradient(45deg, var(--primary-gradient-from), var(--primary-gradient-via), var(--primary-gradient-to))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},onClick:()=>t.push("/auth?tab=login"),children:"Log in"})]})})]})})}var W=t(6766);function q(){let e=(0,l.useRouter)(),r=(0,l.useSearchParams)(),[t,i]=(0,s.useState)("login"),b=(0,o.xd)();return(0,s.useEffect)(()=>{let t=localStorage.getItem("token"),a=localStorage.getItem("user");t&&a&&e.push("/");let s=r.get("tab");("register"===s||"login"===s||"forgot-password"===s)&&i(s)},[e,r]),(0,a.jsx)(n.m,{fluid:!0,p:0,h:"100vh",children:(0,a.jsxs)(d.x,{gutter:0,h:"100%",children:[(0,a.jsx)(d.x.Col,{span:{base:0,md:5},h:"100%",display:{base:"none",md:"block"},className:"mt-[8%]",children:(0,a.jsxs)(u.a,{h:"100%",style:{position:"relative",overflow:"hidden"},children:[(0,a.jsx)(W.default,{src:"/bg-Auth.png",alt:"Authentication background",width:800,height:600,style:{objectFit:"cover",objectPosition:"center",transform:"scale(1.1)",transition:"transform 0.3s ease-in-out"}}),(0,a.jsx)(u.a,{style:{position:"absolute",top:"60%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",color:"white",zIndex:2,width:"90%",maxWidth:"500px",padding:"1rem",backdropFilter:"blur(5px)",borderRadius:"1rem",background:"rgba(255, 255, 255, 0.4)"},children:(0,a.jsxs)(c.Y,{className:"flex items-center",children:[(0,a.jsx)("div",{className:"relative w-12 h-12 overflow-hidden rounded-xl transform transition-transform duration-300",children:(0,a.jsx)(W.default,{src:"/logo2.png",alt:"Logo",fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xl font-bold text-primery",children:"FriendZone"}),(0,a.jsx)("span",{className:"text-xs text-[#666666] dark:text-[#A0A0A0]",children:"Connect & Share"})]}),(0,a.jsx)(m.E,{mt:"md",size:"sm",c:"dimmed",ta:"center",style:{fontStyle:"italic",textShadow:"0 1px 2px rgba(0,0,0,0.2)"},children:"“Nơi c\xe2u chuyện của bạn được lắng nghe.”"})]})})]})}),(0,a.jsx)(d.x.Col,{span:{base:12,md:6},h:"100%",children:(0,a.jsx)(u.a,{h:"100%",style:{display:"flex",flexDirection:"column",justifyContent:"center",padding:"2rem",backgroundColor:b.colors.gray[0]},children:(0,a.jsxs)(u.a,{maw:380,mx:"auto",w:"100%",style:{maxHeight:"90vh",overflowY:"auto",paddingRight:"1rem",scrollbarWidth:"thin",scrollbarColor:"var(--border) var(--background)"},className:"custom-scrollbar",children:[(0,a.jsxs)("div",{className:"flex justify-center items-center gap-2 mb-2 md:mb-4",children:[(0,a.jsx)(W.default,{src:"/logo2.png",alt:"Logo",width:35,height:35}),(0,a.jsx)(g.h,{ta:"center",fw:900,size:"h2",style:{background:"linear-gradient(45deg, var(--primary-gradient-from), var(--primary-gradient-via), var(--primary-gradient-to))",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"login"===t?"Welcome Back!":"register"===t?"Join Us Today!":"Reset Password"})]}),(0,a.jsx)(h.t,{withBorder:!0,shadow:"md",p:24,radius:"md",style:{backgroundColor:"white",backdropFilter:"blur(10px)",borderColor:"var(--border)"},children:(0,a.jsxs)(p.t,{value:t,onChange:r=>{i(r);let t="/auth";"register"===r?t="/auth?tab=register":"forgot-password"===r&&(t="/auth?tab=forgot-password"),e.push(t)},children:[(0,a.jsxs)(p.t.List,{grow:!0,mb:"md",children:[(0,a.jsx)(p.t.Tab,{value:"login",leftSection:(0,a.jsx)(v.A,{style:{width:(0,x.D)(16),height:(0,x.D)(16)}}),children:"Login"}),(0,a.jsx)(p.t.Tab,{value:"register",leftSection:(0,a.jsx)(y.A,{style:{width:(0,x.D)(16),height:(0,x.D)(16)}}),children:"Register"})]}),(0,a.jsx)(p.t.Panel,{value:"login",children:(0,a.jsx)(A,{})}),(0,a.jsx)(p.t.Panel,{value:"register",children:(0,a.jsx)($,{})}),(0,a.jsx)(p.t.Panel,{value:"forgot-password",children:(0,a.jsx)(R,{})})]})})]})})})]})})}function L(){return(0,a.jsxs)("main",{style:{height:"100vh",overflow:"hidden"},children:[(0,a.jsx)(i.$,{position:"top-right",autoClose:2e3}),(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)(n.m,{size:420,my:40,style:{display:"flex",justifyContent:"center",alignItems:"center"},children:(0,a.jsx)(b.a,{size:"xl"})}),children:(0,a.jsx)(q,{})})]})}},8268:(e,r,t)=>{"use strict";t.d(r,{P:()=>l});var a=t(2115),s=t(5407);let l=()=>{let e=(0,a.useContext)(s.R);if(void 0===e)throw Error("useUserData must be used within a UserProvider");return e}}},e=>{var r=r=>e(e.s=r);e.O(0,[545,207,193,525,440,766,109,926,967,36,441,684,358],()=>r(213)),_N_E=e.O()}]);